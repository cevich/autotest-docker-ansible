# Docker Autotest, subtest configuration file template.

{% if test_image_fqin is defined %}[docker_cli/create/create_remote_tag]
config_version = 0.8.5
remote_image_fqin = {{ test_image_fqin }}
run_options_csv ={% endif %}

[docker_cli/pull]
config_version = 0.8.5
docker_pull_timeout = 600
subsubtests = good,wrong_tag,wrong_registry_addr
# Use image from defaults.ini

[docker_cli/run/run_ping]
config_version = 0.8.5
generate_generic = yes
ping_url = "www.redhat.com"
cmd = 'yum install -y iputils && ping -c 3 -q %(ping_url)s'
exit_status = 0

{% if test_image_fqin is defined %}[docker_cli/run/run_remote_tag]
config_version = 0.8.5
remote_image_fqin = {{ test_image_fqin }}
run_options_csv =
cmd = /bin/true{% endif %}

[docker_cli/tag]
config_version = 0.8.5
tag_force = false
gen_lower_only = True
subsubtests = change_tag,change_repository,change_user,double_tag,double_tag_force
tag_repo_name_prefix = test
# Use image from defaults.ini

[docker_cli/pull]
config_version = 0.8.5
#: Maximal duration of the ``docker pull`` command
docker_pull_timeout = 120.0
subsubtests = good,wrong_tag,wrong_registry_addr
#: Allow test to pass if actual result matches this PASS/FAIL value
docker_expected_exit_status = 0

{% if test_image_fqin is defined and ansible_distribution != CentOS %}
[docker_cli/build/https_file]
__example__ = dockerfile_dir_path, postproc_cmd_csv
use_config_repo = no
# This dockerfile pulls the CentOS base image, account for
# this as img_count('2') below.
dockerfile_dir_path = https://raw.githubusercontent.com/autotest/autotest-docker/master/subtests/docker_cli/build/full/Dockerfile
postproc_cmd_csv = positive(),
                   rx_out('\s*Successfully built\s*(\w{64}|\w{12})'),
                   cnt_count('0'),
                   img_count('2'),
                   img_exst(),
                   intr_exst()
{% endif %}
